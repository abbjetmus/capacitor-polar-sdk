{"version":3,"file":"web.js","sourceRoot":"","sources":["../../src/web.ts"],"names":[],"mappings":"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","sourcesContent":["import { WebPlugin } from '@capacitor/core';\n\nimport type {\n  PolarSdkPlugin,\n  PolarSensorSetting,\n  PolarExerciseEntry,\n  PolarExerciseData,\n  PolarOfflineRecordingEntry,\n  PolarOfflineRecordingData,\n  LedConfig,\n  PolarFirstTimeUseConfig,\n  PolarStepsData,\n  PolarDistanceData,\n  PolarActiveTimeData,\n  PolarActivitySampleData,\n  RecordingInterval,\n  SampleType,\n  PolarDeviceInfo\n} from './definitions';\nimport { PolarDataType } from './definitions';\nimport { PftpClient } from './pftp-client';\nimport { initProtobuf, encodeFtuConfig, encodeUserIdentifier, encodeSetLocalTimeParams, createPftpOperation } from './polar-protobuf';\n\ninterface ConnectedDevice {\n  device: any;\n  gattServer: any;\n  heartRateService?: any;\n  batteryService?: any;\n  pmdService?: any;\n  psFtpService?: any;\n  heartRateCharacteristic?: any;\n  batteryCharacteristic?: any;\n  pmdCpCharacteristic?: any;\n  pmdDataCharacteristic?: any;\n  psFtpMtuCharacteristic?: any;\n  psFtpD2HCharacteristic?: any;\n  psFtpH2DCharacteristic?: any;\n  isStreaming: boolean;\n  streamingFeatures: Set<PolarDataType>;\n  offlineRecordings: Map<string, any>;\n  ftuCompleted?: boolean;\n}\n\nconst POLAR_MANUFACTURER_ID = 0x006b;\nconst HEART_RATE_SERVICE = 0x180d;\nconst BATTERY_SERVICE = 0x180f;\nconst HEART_RATE_CHARACTERISTIC = 0x2a37;\nconst BATTERY_CHARACTERISTIC = 0x2a19;\n\nconst PMD_SERVICE = 'fb005c80-02e7-f387-1cad-8acd2d8df0c8';\nconst PMD_CP = 'fb005c81-02e7-f387-1cad-8acd2d8df0c8';\nconst PMD_DATA = 'fb005c82-02e7-f387-1cad-8acd2d8df0c8';\n\nconst PSFTP_SERVICE = '0000feee-0000-1000-8000-00805f9b34fb';\nconst PSFTP_MTU_CHARACTERISTIC = 'fb005c51-02e7-f387-1cad-8acd2d8df0c8';\nconst PSFTP_D2H_NOTIFICATION = 'fb005c52-02e7-f387-1cad-8acd2d8df0c8';\nconst PSFTP_H2D_NOTIFICATION = 'fb005c53-02e7-f387-1cad-8acd2d8df0c8';\n\nconst PMD_COMMAND = {\n  GET_MEASUREMENT_SETTINGS: 0x01,\n  REQUEST_MEASUREMENT_START: 0x02,\n  STOP_MEASUREMENT: 0x03,\n  GET_SDK_MODE_SETTINGS: 0x04,\n  GET_MEASUREMENT_STATUS: 0x05,\n};\n\nconst PMD_MEASUREMENT_TYPE = {\n  ECG: 0x00,\n  PPG: 0x01,\n  ACC: 0x02,\n  PPI: 0x03,\n  GYRO: 0x05,\n  MAGNETOMETER: 0x06,\n  TEMPERATURE: 0x07,\n  PRESSURE: 0x08,\n};\n\nexport class PolarSdkWeb extends WebPlugin implements PolarSdkPlugin {\n  private devices: Map<string, ConnectedDevice> = new Map();\n  private initialized = false;\n  private ftuStatusMap: Map<string, boolean> = new Map();\n\n  async initialize(): Promise<void> {\n    if (!(navigator as any).bluetooth) {\n      throw new Error('Web Bluetooth API is not available in this browser');\n    }\n\n    // Initialize Protocol Buffers\n    try {\n      initProtobuf();\n      console.log('Protocol Buffers initialized for FTU support');\n    } catch (error) {\n      console.warn('Failed to initialize Protocol Buffers:', error);\n    }\n\n    this.initialized = true;\n  }\n\n  async connectToDevice(options: { identifier: string }): Promise<void> {\n    if (!this.initialized) {\n      await this.initialize();\n    }\n\n    if (this.devices.has(options.identifier)) {\n      return;\n    }\n\n    try {\n      const device = await (navigator as any).bluetooth.requestDevice({\n        filters: [\n          { namePrefix: 'Polar 360' }\n        ],\n        optionalServices: [HEART_RATE_SERVICE, BATTERY_SERVICE, PMD_SERVICE, PSFTP_SERVICE],\n      });\n\n      if (!device.gatt) {\n        throw new Error('GATT server not available');\n      }\n\n      const deviceInfo: PolarDeviceInfo = {\n        deviceId: options.identifier,\n        address: device.id,\n        rssi: 0,\n        name: device.name || 'Unknown',\n        isConnectable: true,\n      };\n\n      this.notifyListeners('deviceConnecting', deviceInfo);\n\n      const gattServer = await device.gatt.connect();\n\n      const connectedDevice: ConnectedDevice = {\n        device,\n        gattServer,\n        isStreaming: false,\n        streamingFeatures: new Set(),\n        offlineRecordings: new Map(),\n      };\n\n      this.devices.set(options.identifier, connectedDevice);\n\n      device.addEventListener('gattserverdisconnected', () => {\n        this.handleDeviceDisconnected(options.identifier);\n      });\n\n      this.notifyListeners('deviceConnected', deviceInfo);\n\n      await this.setupBatteryService(options.identifier);\n    } catch (error) {\n      throw new Error(`Failed to connect: ${error}`);\n    }\n  }\n\n  async disconnectFromDevice(options: { identifier: string }): Promise<void> {\n    const connectedDevice = this.devices.get(options.identifier);\n    if (!connectedDevice) {\n      return;\n    }\n\n    if (connectedDevice.isStreaming) {\n      await this.stopStreaming({ identifier: options.identifier, feature: PolarDataType.HR });\n    }\n\n    if (connectedDevice.gattServer.connected) {\n      connectedDevice.gattServer.disconnect();\n    }\n\n    this.devices.delete(options.identifier);\n  }\n\n  async searchForDevice(): Promise<{ value: boolean }> {\n    if (!this.initialized) {\n      await this.initialize();\n    }\n\n    try {\n      const device = await (navigator as any).bluetooth.requestDevice({\n        filters: [\n          { namePrefix: 'Polar 360' }\n        ],\n        optionalServices: [HEART_RATE_SERVICE, BATTERY_SERVICE, PMD_SERVICE, PSFTP_SERVICE],\n      });\n\n      const deviceId = this.extractDeviceId(device.name || '');\n\n      const deviceInfo: PolarDeviceInfo = {\n        deviceId: deviceId,\n        address: device.id,\n        rssi: 0,\n        name: device.name || 'Unknown',\n        isConnectable: true,\n      };\n\n      this.notifyListeners('deviceFound', deviceInfo);\n\n      // Automatically connect within the same user gesture\n      if (!this.devices.has(deviceId)) {\n        let gattServer;\n        try {\n          console.log('Attempting GATT connection...');\n          gattServer = await device.gatt?.connect();\n        } catch (connectError: any) {\n          console.warn('âŒ First connection attempt failed:', connectError.message);\n\n          // If connection fails, try to forget stale pairing and reconnect\n          if (connectError.message?.includes('Connection') || connectError.message?.includes('GATT')) {\n            console.log('ðŸ”„ Attempting to forget device and re-pair...');\n\n            try {\n              // Try to forget the device\n              if (typeof (device as any).forget === 'function') {\n                console.log('Forgetting device...');\n                await (device as any).forget();\n                console.log('âœ… Device forgotten');\n\n                // Wait a moment\n                await new Promise(resolve => setTimeout(resolve, 500));\n\n                // Request device again for fresh pairing\n                console.log('Requesting fresh pairing...');\n                const freshDevice = await (navigator as any).bluetooth.requestDevice({\n                  filters: [\n                    {\n                      namePrefix: 'Polar 360',\n                      manufacturerData: [{ companyIdentifier: POLAR_MANUFACTURER_ID }],\n                    },\n                  ],\n                  acceptAllDevices: false,\n                  optionalServices: [HEART_RATE_SERVICE, BATTERY_SERVICE, PMD_SERVICE, PSFTP_SERVICE],\n                });\n\n                console.log('Connecting to freshly paired device...');\n                gattServer = await freshDevice.gatt?.connect();\n                console.log('âœ… Connected successfully after re-pairing!');\n\n                // Update device reference for the rest of the code\n                (device as any) = freshDevice;\n              } else {\n                // device.forget() not available, try simple retry\n                console.log('device.forget() not available, trying simple retry...');\n                await new Promise(resolve => setTimeout(resolve, 1000));\n                gattServer = await device.gatt?.connect();\n              }\n            } catch (retryError: any) {\n              console.error('âŒ Re-pairing failed:', retryError.message);\n              throw new Error(\n                'âŒ Connection failed. Manual re-pairing required:\\n\\n' +\n                '1. Open chrome://bluetooth-internals/#devices\\n' +\n                '2. Find \"Polar 360\" and click \"Forget\" or \"Remove\"\\n' +\n                '3. Close and reopen this browser tab\\n' +\n                '4. Make sure device LED is blinking (pairing mode)\\n' +\n                '5. Try connecting again\\n\\n' +\n                `Original error: ${connectError.message}`\n              );\n            }\n          } else {\n            throw connectError;\n          }\n        }\n\n        if (!gattServer) {\n          throw new Error('Failed to establish GATT connection');\n        }\n\n        const connectedDevice: ConnectedDevice = {\n          device,\n          gattServer,\n          isStreaming: false,\n          streamingFeatures: new Set(),\n          offlineRecordings: new Map(),\n        };\n\n        this.devices.set(deviceId, connectedDevice);\n\n        device.addEventListener('gattserverdisconnected', () => {\n          this.handleDeviceDisconnected(deviceId);\n        });\n\n        this.notifyListeners('deviceConnected', deviceInfo);\n        await this.setupBatteryService(deviceId);\n      }\n\n      return { value: true };\n    } catch (error: any) {\n      console.error('Device search error:', error);\n      console.error('Error details:', {\n        message: error.message,\n        name: error.name,\n        code: error.code\n      });\n      throw error;\n    }\n  }\n\n  async getAvailableOnlineStreamDataTypes(options: { identifier: string }): Promise<{ types: PolarDataType[] }> {\n    const connectedDevice = this.devices.get(options.identifier);\n    if (!connectedDevice) {\n      throw new Error('Device not connected');\n    }\n\n    const types: PolarDataType[] = [PolarDataType.HR, PolarDataType.PPI];\n\n    return { types };\n  }\n\n  async requestStreamSettings(_options: { identifier: string; feature: PolarDataType }): Promise<PolarSensorSetting> {\n    return { settings: {} };\n  }\n\n  async startHrStreaming(options: { identifier: string }): Promise<{ value: boolean }> {\n    const connectedDevice = this.devices.get(options.identifier);\n    if (!connectedDevice) {\n      throw new Error('Device not connected');\n    }\n\n    try {\n      if (!connectedDevice.heartRateService) {\n        connectedDevice.heartRateService = await connectedDevice.gattServer.getPrimaryService(HEART_RATE_SERVICE);\n      }\n\n      if (!connectedDevice.heartRateCharacteristic) {\n        connectedDevice.heartRateCharacteristic = await connectedDevice.heartRateService.getCharacteristic(\n          HEART_RATE_CHARACTERISTIC\n        );\n      }\n\n      connectedDevice.heartRateCharacteristic.addEventListener('characteristicvaluechanged', (event: Event) => {\n        const target = event.target as any;\n        const value = target.value;\n        if (value) {\n          const hrData = this.parseHeartRate(value);\n          this.notifyListeners('hrData', {\n            identifier: options.identifier,\n            data: { hr: hrData, rrs: [], contactStatus: true, contactStatusSupported: false },\n          });\n        }\n      });\n\n      await connectedDevice.heartRateCharacteristic.startNotifications();\n      connectedDevice.isStreaming = true;\n\n      this.notifyListeners('sdkFeatureReady', { identifier: options.identifier, feature: PolarDataType.HR });\n\n      return { value: true };\n    } catch (error) {\n      throw new Error(`Failed to start HR streaming: ${error}`);\n    }\n  }\n\n  async startEcgStreaming(_options: { identifier: string; settings?: PolarSensorSetting }): Promise<{ value: boolean }> {\n    throw this.unimplemented('ECG streaming not supported on web.');\n  }\n\n  async startAccStreaming(_options: { identifier: string; settings?: PolarSensorSetting }): Promise<{ value: boolean }> {\n    throw this.unimplemented('Accelerometer streaming not supported on web.');\n  }\n\n  async startGyroStreaming(_options: { identifier: string; settings?: PolarSensorSetting }): Promise<{ value: boolean }> {\n    throw this.unimplemented('Gyroscope streaming not supported on web.');\n  }\n\n  async startMagnetometerStreaming(_options: { identifier: string; settings?: PolarSensorSetting }): Promise<{ value: boolean }> {\n    throw this.unimplemented('Magnetometer streaming not supported on web.');\n  }\n\n  async startPpgStreaming(_options: { identifier: string; settings?: PolarSensorSetting }): Promise<{ value: boolean }> {\n    throw this.unimplemented('PPG streaming not supported on web.');\n  }\n\n  async startPpiStreaming(options: { identifier: string }): Promise<{ value: boolean }> {\n    const connectedDevice = this.devices.get(options.identifier);\n    if (!connectedDevice) {\n      throw new Error('Device not connected');\n    }\n\n    try {\n      if (!connectedDevice.pmdService) {\n        connectedDevice.pmdService = await connectedDevice.gattServer.getPrimaryService(PMD_SERVICE);\n      }\n\n      if (!connectedDevice.pmdCpCharacteristic) {\n        connectedDevice.pmdCpCharacteristic = await connectedDevice.pmdService.getCharacteristic(PMD_CP);\n      }\n\n      if (!connectedDevice.pmdDataCharacteristic) {\n        connectedDevice.pmdDataCharacteristic = await connectedDevice.pmdService.getCharacteristic(PMD_DATA);\n      }\n\n      connectedDevice.pmdDataCharacteristic.addEventListener('characteristicvaluechanged', (event: Event) => {\n        const target = event.target as any;\n        const value = target.value;\n        if (value) {\n          const ppiData = this.parsePmdData(value, PMD_MEASUREMENT_TYPE.PPI);\n          if (ppiData) {\n            this.notifyListeners('ppiData', {\n              identifier: options.identifier,\n              data: ppiData,\n            });\n          }\n        }\n      });\n\n      await connectedDevice.pmdDataCharacteristic.startNotifications();\n\n      const startCommand = new Uint8Array([\n        PMD_COMMAND.REQUEST_MEASUREMENT_START,\n        PMD_MEASUREMENT_TYPE.PPI,\n      ]);\n\n      await connectedDevice.pmdCpCharacteristic.writeValue(startCommand);\n      connectedDevice.streamingFeatures.add(PolarDataType.PPI);\n\n      this.notifyListeners('sdkFeatureReady', { identifier: options.identifier, feature: PolarDataType.PPI });\n\n      return { value: true };\n    } catch (error) {\n      throw new Error(`Failed to start PPI streaming: ${error}`);\n    }\n  }\n\n  async startTemperatureStreaming(_options: { identifier: string; settings?: PolarSensorSetting }): Promise<{ value: boolean }> {\n    throw this.unimplemented('Temperature streaming not supported on web.');\n  }\n\n  async startPressureStreaming(_options: { identifier: string; settings?: PolarSensorSetting }): Promise<{ value: boolean }> {\n    throw this.unimplemented('Pressure streaming not supported on web.');\n  }\n\n  async stopStreaming(options: { identifier: string; feature: PolarDataType }): Promise<{ value: boolean }> {\n    const connectedDevice = this.devices.get(options.identifier);\n    if (!connectedDevice) {\n      throw new Error('Device not connected');\n    }\n\n    try {\n      if (options.feature === PolarDataType.HR && connectedDevice.heartRateCharacteristic) {\n        await connectedDevice.heartRateCharacteristic.stopNotifications();\n        connectedDevice.isStreaming = false;\n      } else if (options.feature === PolarDataType.PPI && connectedDevice.pmdCpCharacteristic) {\n        const stopCommand = new Uint8Array([\n          PMD_COMMAND.STOP_MEASUREMENT,\n          PMD_MEASUREMENT_TYPE.PPI,\n        ]);\n        await connectedDevice.pmdCpCharacteristic.writeValue(stopCommand);\n        connectedDevice.streamingFeatures.delete(PolarDataType.PPI);\n      }\n      return { value: true };\n    } catch (error) {\n      throw new Error(`Failed to stop streaming: ${error}`);\n    }\n  }\n\n  private async setupBatteryService(identifier: string): Promise<void> {\n    const connectedDevice = this.devices.get(identifier);\n    if (!connectedDevice) return;\n\n    try {\n      connectedDevice.batteryService = await connectedDevice.gattServer.getPrimaryService(BATTERY_SERVICE);\n      connectedDevice.batteryCharacteristic = await connectedDevice.batteryService.getCharacteristic(BATTERY_CHARACTERISTIC);\n\n      connectedDevice.batteryCharacteristic.addEventListener('characteristicvaluechanged', (event: Event) => {\n        const target = event.target as any;\n        const value = target.value;\n        if (value) {\n          const batteryLevel = this.parseBatteryLevel(value);\n          this.notifyListeners('batteryLevelReceived', { identifier, level: batteryLevel });\n        }\n      });\n\n      await connectedDevice.batteryCharacteristic.startNotifications();\n\n      const batteryData = await connectedDevice.batteryCharacteristic.readValue();\n      const batteryLevel = this.parseBatteryLevel(batteryData);\n      this.notifyListeners('batteryLevelReceived', { identifier, level: batteryLevel });\n    } catch (error) {\n      console.error('Battery service setup failed:', error);\n    }\n  }\n\n  private parseHeartRate(data: DataView): number {\n    const flags = data.getUint8(0);\n    const hrFormat = flags & 0x01;\n\n    if (hrFormat === 0) {\n      return data.getUint8(1);\n    } else {\n      return data.getUint16(1, true);\n    }\n  }\n\n  private parseBatteryLevel(data: DataView): number {\n    return data.getUint8(0);\n  }\n\n  private extractDeviceId(name: string): string {\n    const match = name.match(/Polar 360 (.+)/);\n    return match ? match[1] : name;\n  }\n\n  private getDataTypeName(dataType: PolarDataType): string {\n    switch (dataType) {\n      case PolarDataType.HR: return 'HR';\n      case PolarDataType.ECG: return 'ECG';\n      case PolarDataType.ACC: return 'ACC';\n      case PolarDataType.PPG: return 'PPG';\n      case PolarDataType.PPI: return 'PPI';\n      case PolarDataType.GYRO: return 'GYRO';\n      case PolarDataType.MAGNETOMETER: return 'MAG';\n      case PolarDataType.TEMPERATURE: return 'TEMP';\n      case PolarDataType.PRESSURE: return 'PRESS';\n      default: return 'UNKNOWN';\n    }\n  }\n\n  private handleDeviceDisconnected(identifier: string): void {\n    const connectedDevice = this.devices.get(identifier);\n    if (connectedDevice) {\n      const deviceInfo: PolarDeviceInfo = {\n        deviceId: identifier,\n        address: connectedDevice.device.id,\n        rssi: 0,\n        name: connectedDevice.device.name || 'Unknown',\n        isConnectable: false,\n      };\n\n      this.notifyListeners('deviceDisconnected', deviceInfo);\n      this.devices.delete(identifier);\n    }\n  }\n\n  private parsePmdData(data: DataView, measurementType: number): any {\n    if (measurementType === PMD_MEASUREMENT_TYPE.PPI) {\n      return this.parsePpiData(data);\n    }\n    return null;\n  }\n\n  private parsePpiData(data: DataView): any {\n    const samples: any[] = [];\n\n    try {\n      let offset = 0;\n\n      if (data.byteLength < 1) return { samples };\n\n      const frameType = data.getUint8(offset);\n      offset++;\n\n      if (frameType === 0x00) {\n        const timestamp = data.getUint32(offset, true);\n        offset += 8;\n\n        while (offset < data.byteLength) {\n          if (offset + 5 > data.byteLength) break;\n\n          const ppInterval = data.getUint16(offset, true);\n          offset += 2;\n\n          const errorEstimate = data.getUint16(offset, true);\n          offset += 2;\n\n          const flags = data.getUint8(offset);\n          offset++;\n\n          const blocker = (flags & 0x01) !== 0;\n          const skinContactSupported = (flags & 0x02) !== 0;\n          const skinContact = (flags & 0x04) !== 0;\n\n          samples.push({\n            ppInterval,\n            errorEstimate,\n            blocker,\n            skinContactSupported,\n            skinContact,\n          });\n        }\n\n        return { samples, timestamp };\n      }\n    } catch (error) {\n      console.error('Error parsing PPI data:', error);\n    }\n\n    return { samples };\n  }\n\n  async startRecording(options: {\n    identifier: string;\n    exerciseId: string;\n    interval: RecordingInterval;\n    sampleType: SampleType;\n  }): Promise<void> {\n    console.log('startRecording', options);\n    throw this.unimplemented('Not implemented on web.');\n  }\n\n  async stopRecording(options: { identifier: string }): Promise<void> {\n    console.log('stopRecording', options);\n    throw this.unimplemented('Not implemented on web.');\n  }\n\n  async requestRecordingStatus(options: { identifier: string }): Promise<{ ongoing: boolean; entryId: string }> {\n    console.log('requestRecordingStatus', options);\n    throw this.unimplemented('Not implemented on web.');\n  }\n\n  async listExercises(options: { identifier: string }): Promise<{ entries: PolarExerciseEntry[] }> {\n    console.log('listExercises', options);\n    throw this.unimplemented('Not implemented on web.');\n  }\n\n  async fetchExercise(options: { identifier: string; entry: PolarExerciseEntry }): Promise<PolarExerciseData> {\n    console.log('fetchExercise', options);\n    throw this.unimplemented('Not implemented on web.');\n  }\n\n  async removeExercise(options: { identifier: string; entry: PolarExerciseEntry }): Promise<void> {\n    console.log('removeExercise', options);\n    throw this.unimplemented('Not implemented on web.');\n  }\n\n  async setLedConfig(options: { identifier: string; config: LedConfig }): Promise<void> {\n    console.log('setLedConfig', options);\n    throw this.unimplemented('Not implemented on web.');\n  }\n\n  async doFactoryReset(options: { identifier: string; preservePairingInformation: boolean }): Promise<void> {\n    console.log('doFactoryReset', options);\n    throw this.unimplemented('Not implemented on web.');\n  }\n\n  async enableSdkMode(options: { identifier: string }): Promise<void> {\n    console.log('enableSdkMode', options);\n    throw this.unimplemented('Not implemented on web.');\n  }\n\n  async disableSdkMode(options: { identifier: string }): Promise<void> {\n    console.log('disableSdkMode', options);\n    throw this.unimplemented('Not implemented on web.');\n  }\n\n  async isSdkModeEnabled(options: { identifier: string }): Promise<{ enabled: boolean }> {\n    console.log('isSdkModeEnabled', options);\n    throw this.unimplemented('Not implemented on web.');\n  }\n\n  async getAvailableOfflineRecordingDataTypes(options: { identifier: string }): Promise<{ types: PolarDataType[] }> {\n    const connectedDevice = this.devices.get(options.identifier);\n    if (!connectedDevice) {\n      throw new Error('Device not connected');\n    }\n\n    const types: PolarDataType[] = [PolarDataType.PPI, PolarDataType.ACC, PolarDataType.PPG];\n    return { types };\n  }\n\n  async requestOfflineRecordingSettings(options: {\n    identifier: string;\n    feature: PolarDataType;\n  }): Promise<PolarSensorSetting | null> {\n    const connectedDevice = this.devices.get(options.identifier);\n    if (!connectedDevice) {\n      throw new Error('Device not connected');\n    }\n\n    return { settings: {} };\n  }\n\n  async startOfflineRecording(options: {\n    identifier: string;\n    feature: PolarDataType;\n    settings?: PolarSensorSetting;\n  }): Promise<void> {\n    const connectedDevice = this.devices.get(options.identifier);\n    if (!connectedDevice) {\n      throw new Error('Device not connected');\n    }\n\n    try {\n      if (!connectedDevice.pmdService) {\n        connectedDevice.pmdService = await connectedDevice.gattServer.getPrimaryService(PMD_SERVICE);\n      }\n\n      if (!connectedDevice.pmdCpCharacteristic) {\n        connectedDevice.pmdCpCharacteristic = await connectedDevice.pmdService.getCharacteristic(PMD_CP);\n      }\n\n      let measurementType = PMD_MEASUREMENT_TYPE.PPI;\n      if (options.feature === PolarDataType.ACC) {\n        measurementType = PMD_MEASUREMENT_TYPE.ACC;\n      } else if (options.feature === PolarDataType.PPG) {\n        measurementType = PMD_MEASUREMENT_TYPE.PPG;\n      }\n\n      const startCommand = new Uint8Array([\n        PMD_COMMAND.REQUEST_MEASUREMENT_START,\n        measurementType,\n      ]);\n\n      await connectedDevice.pmdCpCharacteristic.writeValue(startCommand);\n      connectedDevice.streamingFeatures.add(options.feature);\n    } catch (error) {\n      throw new Error(`Failed to start offline recording: ${error}`);\n    }\n  }\n\n  async stopOfflineRecording(options: { identifier: string; feature: PolarDataType }): Promise<void> {\n    const connectedDevice = this.devices.get(options.identifier);\n    if (!connectedDevice) {\n      throw new Error('Device not connected');\n    }\n\n    try {\n      if (!connectedDevice.pmdCpCharacteristic) {\n        throw new Error('PMD service not initialized');\n      }\n\n      let measurementType = PMD_MEASUREMENT_TYPE.PPI;\n      if (options.feature === PolarDataType.ACC) {\n        measurementType = PMD_MEASUREMENT_TYPE.ACC;\n      } else if (options.feature === PolarDataType.PPG) {\n        measurementType = PMD_MEASUREMENT_TYPE.PPG;\n      }\n\n      const stopCommand = new Uint8Array([\n        PMD_COMMAND.STOP_MEASUREMENT,\n        measurementType,\n      ]);\n\n      await connectedDevice.pmdCpCharacteristic.writeValue(stopCommand);\n      connectedDevice.streamingFeatures.delete(options.feature);\n    } catch (error) {\n      throw new Error(`Failed to stop offline recording: ${error}`);\n    }\n  }\n\n  async getOfflineRecordingStatus(options: { identifier: string }): Promise<{ features: PolarDataType[] }> {\n    const connectedDevice = this.devices.get(options.identifier);\n    if (!connectedDevice) {\n      throw new Error('Device not connected');\n    }\n\n    return { features: Array.from(connectedDevice.streamingFeatures) };\n  }\n\n  async listOfflineRecordings(options: { identifier: string }): Promise<{ entries: PolarOfflineRecordingEntry[] }> {\n    const connectedDevice = this.devices.get(options.identifier);\n    if (!connectedDevice) {\n      throw new Error('Device not connected');\n    }\n\n    try {\n      if (!connectedDevice.psFtpService) {\n        connectedDevice.psFtpService = await connectedDevice.gattServer.getPrimaryService(PSFTP_SERVICE);\n      }\n\n      const recordings = connectedDevice.streamingFeatures;\n      const entries: PolarOfflineRecordingEntry[] = [];\n\n      recordings.forEach((feature) => {\n        const type = this.getDataTypeName(feature);\n        entries.push({\n          path: `/DATA/${type}/RECORDING_${Date.now()}.dat`,\n          size: 0,\n          date: new Date().toISOString(),\n          type: type,\n        });\n      });\n\n      return { entries };\n    } catch (error) {\n      console.warn('PFTP service not available. Returning cached recordings.');\n      return { entries: [] };\n    }\n  }\n\n  async getOfflineRecord(options: {\n    identifier: string;\n    entry: PolarOfflineRecordingEntry;\n  }): Promise<PolarOfflineRecordingData> {\n    const connectedDevice = this.devices.get(options.identifier);\n    if (!connectedDevice) {\n      throw new Error('Device not connected');\n    }\n\n    try {\n      if (!connectedDevice.psFtpService) {\n        connectedDevice.psFtpService = await connectedDevice.gattServer.getPrimaryService(PSFTP_SERVICE);\n      }\n\n      if (!connectedDevice.psFtpMtuCharacteristic) {\n        connectedDevice.psFtpMtuCharacteristic = await connectedDevice.psFtpService.getCharacteristic(PSFTP_MTU_CHARACTERISTIC);\n      }\n\n      if (!connectedDevice.psFtpD2HCharacteristic) {\n        connectedDevice.psFtpD2HCharacteristic = await connectedDevice.psFtpService.getCharacteristic(PSFTP_D2H_NOTIFICATION);\n      }\n\n      if (!connectedDevice.psFtpH2DCharacteristic) {\n        connectedDevice.psFtpH2DCharacteristic = await connectedDevice.psFtpService.getCharacteristic(PSFTP_H2D_NOTIFICATION);\n      }\n\n      await connectedDevice.psFtpD2HCharacteristic.startNotifications();\n\n      const recordingData = connectedDevice.offlineRecordings.get(options.entry.path);\n\n      if (recordingData) {\n        return {\n          startTime: recordingData.startTime || new Date().toISOString(),\n          settings: recordingData.settings,\n        };\n      }\n\n      console.warn('Full PFTP implementation required for actual file retrieval');\n      return {\n        startTime: new Date().toISOString(),\n        settings: undefined,\n      };\n    } catch (error) {\n      throw new Error(`Failed to retrieve offline record: ${error}`);\n    }\n  }\n\n  async removeOfflineRecord(options: { identifier: string; entry: PolarOfflineRecordingEntry }): Promise<void> {\n    const connectedDevice = this.devices.get(options.identifier);\n    if (!connectedDevice) {\n      throw new Error('Device not connected');\n    }\n\n    try {\n      connectedDevice.offlineRecordings.delete(options.entry.path);\n      console.warn('Full PFTP implementation required for actual file deletion from device');\n    } catch (error) {\n      throw new Error(`Failed to remove offline record: ${error}`);\n    }\n  }\n\n  async getDiskSpace(options: { identifier: string }): Promise<{ freeSpace: number; totalSpace: number }> {\n    console.log('getDiskSpace', options);\n    throw this.unimplemented('Not implemented on web.');\n  }\n\n  async getLocalTime(options: { identifier: string }): Promise<{ time: string }> {\n    console.log('getLocalTime', options);\n    throw this.unimplemented('Not implemented on web.');\n  }\n\n  async setLocalTime(options: { identifier: string; time: Date }): Promise<void> {\n    const connectedDevice = this.devices.get(options.identifier);\n    if (!connectedDevice) {\n      throw new Error(`Device ${options.identifier} is not connected`);\n    }\n\n    try {\n      if (!connectedDevice.psFtpService) {\n        const gattServer = connectedDevice.gattServer;\n        connectedDevice.psFtpService = await gattServer.getPrimaryService(PSFTP_SERVICE);\n      }\n\n      if (!connectedDevice.psFtpMtuCharacteristic) {\n        connectedDevice.psFtpMtuCharacteristic = await connectedDevice.psFtpService.getCharacteristic(PSFTP_MTU_CHARACTERISTIC);\n      }\n\n      if (!connectedDevice.psFtpD2HCharacteristic) {\n        connectedDevice.psFtpD2HCharacteristic = await connectedDevice.psFtpService.getCharacteristic(PSFTP_D2H_NOTIFICATION);\n      }\n\n      console.log(`Setting local time to ${options.time.toISOString()}`);\n\n      const pftpClient = new PftpClient(\n        connectedDevice.psFtpMtuCharacteristic,\n        connectedDevice.psFtpD2HCharacteristic,\n        connectedDevice.psFtpH2DCharacteristic\n      );\n\n      await pftpClient.initialize();\n\n      const SET_LOCAL_TIME_QUERY = 3;\n      const timeParams = encodeSetLocalTimeParams(options.time);\n\n      await pftpClient.sendQuery(SET_LOCAL_TIME_QUERY, timeParams);\n\n      console.log('âœ… Local time set successfully');\n    } catch (error) {\n      console.error('Failed to set local time:', error);\n      throw new Error(`Failed to set local time: ${error}`);\n    }\n  }\n\n  async doFirstTimeUse(options: { identifier: string; config: PolarFirstTimeUseConfig }): Promise<void> {\n    const connectedDevice = this.devices.get(options.identifier);\n    if (!connectedDevice) {\n      throw new Error(`Device ${options.identifier} is not connected`);\n    }\n\n    const config = options.config;\n\n    if (config.height < 90 || config.height > 240) {\n      throw new Error('Height must be between 90 and 240 cm');\n    }\n    if (config.weight < 15 || config.weight > 300) {\n      throw new Error('Weight must be between 15 and 300 kg');\n    }\n    if (config.maxHeartRate < 100 || config.maxHeartRate > 240) {\n      throw new Error('Max heart rate must be between 100 and 240 bpm');\n    }\n    if (config.restingHeartRate < 20 || config.restingHeartRate > 120) {\n      throw new Error('Resting heart rate must be between 20 and 120 bpm');\n    }\n    if (config.vo2Max < 10 || config.vo2Max > 95) {\n      throw new Error('VO2 max must be between 10 and 95');\n    }\n    if (config.sleepGoalMinutes < 300 || config.sleepGoalMinutes > 660) {\n      throw new Error('Sleep goal must be between 300 and 660 minutes (5-11 hours)');\n    }\n\n    try {\n      if (!connectedDevice.psFtpService) {\n        const gattServer = connectedDevice.gattServer;\n        connectedDevice.psFtpService = await gattServer.getPrimaryService(PSFTP_SERVICE);\n      }\n\n      if (!connectedDevice.psFtpH2DCharacteristic) {\n        connectedDevice.psFtpH2DCharacteristic = await connectedDevice.psFtpService.getCharacteristic(PSFTP_H2D_NOTIFICATION);\n      }\n\n      if (!connectedDevice.psFtpD2HCharacteristic) {\n        connectedDevice.psFtpD2HCharacteristic = await connectedDevice.psFtpService.getCharacteristic(PSFTP_D2H_NOTIFICATION);\n      }\n\n      if (!connectedDevice.psFtpMtuCharacteristic) {\n        connectedDevice.psFtpMtuCharacteristic = await connectedDevice.psFtpService.getCharacteristic(PSFTP_MTU_CHARACTERISTIC);\n      }\n\n      console.log('=== WRITING FTU CONFIGURATION TO DEVICE ===');\n      console.log('FTU Config:', {\n        gender: config.gender,\n        birthDate: config.birthDate,\n        height: config.height,\n        weight: config.weight,\n        maxHR: config.maxHeartRate,\n        vo2Max: config.vo2Max,\n        restingHR: config.restingHeartRate,\n        trainingBg: config.trainingBackground,\n        typicalDay: config.typicalDay,\n        sleepGoal: config.sleepGoalMinutes\n      });\n\n      // Encode FTU config to Protocol Buffers\n      console.log('Encoding FTU config to protobuf...');\n      const ftuData = encodeFtuConfig({\n        gender: config.gender as 'MALE' | 'FEMALE',\n        birthDate: config.birthDate,\n        height: config.height,\n        weight: config.weight,\n        maxHeartRate: config.maxHeartRate,\n        vo2Max: config.vo2Max,\n        restingHeartRate: config.restingHeartRate,\n        trainingBackground: config.trainingBackground,\n        deviceTime: config.deviceTime,\n        typicalDay: config.typicalDay,\n        sleepGoalMinutes: config.sleepGoalMinutes\n      });\n\n      console.log(`Protobuf encoded: ${ftuData.length} bytes`);\n\n      // Create PFTP client\n      console.log('Initializing PFTP client...');\n      const pftpClient = new PftpClient(\n        connectedDevice.psFtpMtuCharacteristic,\n        connectedDevice.psFtpD2HCharacteristic,\n        connectedDevice.psFtpH2DCharacteristic\n      );\n\n      await pftpClient.initialize();\n\n      // Step 1: Write physical data config\n      const FTU_PATH = '/U/0/S/PHYSDATA.BPB';\n      console.log(`Step 1: Writing ${ftuData.length} bytes to ${FTU_PATH}...`);\n      const pftpOperation = createPftpOperation('PUT', FTU_PATH);\n      await pftpClient.writeFile(FTU_PATH, ftuData, pftpOperation);\n      console.log('âœ… Physical data config written');\n\n      // Step 2: Write user identifier\n      const USER_ID_PATH = '/U/0/USERID.BPB';\n      console.log(`Step 2: Writing user identifier to ${USER_ID_PATH}...`);\n      const userIdData = encodeUserIdentifier(config.deviceTime);\n      const userIdOperation = createPftpOperation('PUT', USER_ID_PATH);\n      await pftpClient.writeFile(USER_ID_PATH, userIdData, userIdOperation);\n      console.log('âœ… User identifier written');\n\n      // Step 3: Set local time\n      console.log(`Step 3: Setting local time...`);\n      const SET_LOCAL_TIME_QUERY = 3;\n      const timeParams = encodeSetLocalTimeParams(new Date(config.deviceTime));\n      await pftpClient.sendQuery(SET_LOCAL_TIME_QUERY, timeParams);\n      console.log('âœ… Local time set');\n\n      console.log('âœ…âœ…âœ… FTU COMPLETED! Device should stop blinking now âœ…âœ…âœ…');\n\n      this.ftuStatusMap.set(options.identifier, true);\n      connectedDevice.ftuCompleted = true;\n\n      this.notifyListeners('ftuCompleted', {\n        identifier: options.identifier,\n        success: true\n      });\n\n      console.log('================================================');\n    } catch (error) {\n      console.error('Failed to write FTU configuration:', error);\n      throw new Error(`Failed to perform First Time Use: ${error}`);\n    }\n  }\n\n  async getConnectionStatus(options: { identifier: string }): Promise<{\n    connected: boolean;\n    gattConnected: boolean;\n    deviceName: string;\n    services: string[];\n    browserPaired: boolean;\n    details: string;\n  }> {\n    console.log('ðŸ” Checking connection status for:', options.identifier);\n\n    // Check if we have the device in our map\n    const connectedDevice = this.devices.get(options.identifier);\n\n    // Check browser's paired devices\n    let browserPaired = false;\n    let pairedDevices: any[] = [];\n    try {\n      if (typeof (navigator as any).bluetooth?.getDevices === 'function') {\n        pairedDevices = await (navigator as any).bluetooth.getDevices();\n        browserPaired = pairedDevices.some((d: any) =>\n          d.name?.includes('Polar') || d.id === options.identifier\n        );\n        console.log('Browser paired devices:', pairedDevices.map((d: any) => ({ name: d.name, id: d.id })));\n      }\n    } catch (e) {\n      console.warn('Could not check browser paired devices:', e);\n    }\n\n    if (!connectedDevice) {\n      const details = browserPaired\n        ? `âš ï¸ Device is paired in browser but not connected in app. Found ${pairedDevices.length} paired device(s).`\n        : 'âŒ Device not found in app and not paired in browser.';\n\n      console.log(details);\n\n      return {\n        connected: false,\n        gattConnected: false,\n        deviceName: 'Not in app',\n        services: [],\n        browserPaired,\n        details\n      };\n    }\n\n    const gattConnected = connectedDevice.gattServer?.connected || false;\n    const deviceName = connectedDevice.device?.name || 'Unknown';\n\n    // Try to list available services\n    const services: string[] = [];\n    if (gattConnected) {\n      try {\n        if (connectedDevice.heartRateService) services.push('Heart Rate');\n        if (connectedDevice.batteryService) services.push('Battery');\n        if (connectedDevice.pmdService) services.push('PMD');\n        if (connectedDevice.psFtpService) services.push('PFTP');\n      } catch (e) {\n        console.warn('Error checking services:', e);\n      }\n    }\n\n    const details = gattConnected\n      ? `âœ… GATT connected with ${services.length} service(s) available`\n      : `âš ï¸ Device in app but GATT NOT connected. Browser paired: ${browserPaired}`;\n\n    console.log('ðŸ“Š Connection Status:', {\n      connected: true,\n      gattConnected,\n      deviceName,\n      services,\n      browserPaired,\n      details\n    });\n\n    return {\n      connected: true,\n      gattConnected,\n      deviceName,\n      services,\n      browserPaired,\n      details\n    };\n  }\n\n  async isFtuDone(options: { identifier: string }): Promise<{ done: boolean; message?: string }> {\n    console.log('ðŸ” Checking FTU status...');\n\n    const connectedDevice = this.devices.get(options.identifier);\n    if (!connectedDevice) {\n      console.warn('âŒ Device not found in app - cannot check FTU');\n      return {\n        done: false,\n        message: 'âŒ Device not connected in app. Click \"Connect\" first.'\n      };\n    }\n\n    // Check if GATT is actually connected\n    if (!connectedDevice.gattServer?.connected) {\n      console.warn('âš ï¸ GATT not connected - cannot check FTU status');\n      return {\n        done: false,\n        message: 'âš ï¸ GATT not connected. Device paired but not active.'\n      };\n    }\n\n    // Try to actually check by reading the user identifier file\n    try {\n      console.log('ðŸ” Checking FTU status by reading USERID.BPB...');\n\n      if (!connectedDevice.psFtpService) {\n        const gattServer = connectedDevice.gattServer;\n        connectedDevice.psFtpService = await gattServer.getPrimaryService(PSFTP_SERVICE);\n      }\n\n      if (!connectedDevice.psFtpMtuCharacteristic) {\n        connectedDevice.psFtpMtuCharacteristic = await connectedDevice.psFtpService.getCharacteristic(PSFTP_MTU_CHARACTERISTIC);\n      }\n\n      if (!connectedDevice.psFtpD2HCharacteristic) {\n        connectedDevice.psFtpD2HCharacteristic = await connectedDevice.psFtpService.getCharacteristic(PSFTP_D2H_NOTIFICATION);\n      }\n\n      const pftpClient = new PftpClient(\n        connectedDevice.psFtpMtuCharacteristic,\n        connectedDevice.psFtpD2HCharacteristic,\n        connectedDevice.psFtpH2DCharacteristic\n      );\n\n      await pftpClient.initialize();\n\n      // Try to read the user identifier file\n      const USER_ID_PATH = '/U/0/USERID.BPB';\n      const operation = createPftpOperation('GET', USER_ID_PATH);\n\n      try {\n        await pftpClient.sendQuery(0, operation); // GET query\n        console.log('âœ… FTU is DONE (USERID.BPB exists)');\n        this.ftuStatusMap.set(options.identifier, true);\n        connectedDevice.ftuCompleted = true;\n        return {\n          done: true,\n          message: 'âœ… FTU completed! USERID.BPB exists on device.'\n        };\n      } catch (error) {\n        console.log('âŒ FTU is NOT done (USERID.BPB does not exist)');\n        return {\n          done: false,\n          message: 'âŒ FTU not done. USERID.BPB file not found on device.'\n        };\n      }\n    } catch (error: any) {\n      console.error('Error checking FTU status:', error);\n      // Fall back to cached status\n      const done = this.ftuStatusMap.get(options.identifier) || connectedDevice.ftuCompleted || false;\n      console.log(`Falling back to cached FTU status: ${done}`);\n      return {\n        done,\n        message: `âš ï¸ Could not verify on device. Cached status: ${done ? 'Done' : 'Not done'}. Error: ${error.message}`\n      };\n    }\n  }\n\n  async deleteStoredDeviceData(options: { identifier: string; dataType: number; until: string }): Promise<void> {\n    console.log('deleteStoredDeviceData', options);\n    throw this.unimplemented('Not implemented on web.');\n  }\n\n  async deleteDeviceDateFolders(options: { identifier: string; fromDate: string; toDate: string }): Promise<void> {\n    console.log('deleteDeviceDateFolders', options);\n    throw this.unimplemented('Not implemented on web.');\n  }\n\n  async getSteps(options: { identifier: string; fromDate: string; toDate: string }): Promise<{ data: PolarStepsData[] }> {\n    console.log('getSteps', options);\n    throw this.unimplemented('Not implemented on web.');\n  }\n\n  async getDistance(options: {\n    identifier: string;\n    fromDate: string;\n    toDate: string;\n  }): Promise<{ data: PolarDistanceData[] }> {\n    console.log('getDistance', options);\n    throw this.unimplemented('Not implemented on web.');\n  }\n\n  async getActiveTime(options: {\n    identifier: string;\n    fromDate: string;\n    toDate: string;\n  }): Promise<{ data: PolarActiveTimeData[] }> {\n    console.log('getActiveTime', options);\n    throw this.unimplemented('Not implemented on web.');\n  }\n\n  async getActivitySampleData(options: {\n    identifier: string;\n    fromDate: string;\n    toDate: string;\n  }): Promise<{ data: PolarActivitySampleData[] }> {\n    console.log('getActivitySampleData', options);\n    throw this.unimplemented('Not implemented on web.');\n  }\n\n  async sendInitializationAndStartSyncNotifications(options: { identifier: string }): Promise<{ success: boolean }> {\n    console.log('sendInitializationAndStartSyncNotifications', options);\n    throw this.unimplemented('Not implemented on web.');\n  }\n\n  async sendTerminateAndStopSyncNotifications(options: { identifier: string }): Promise<void> {\n    console.log('sendTerminateAndStopSyncNotifications', options);\n    throw this.unimplemented('Not implemented on web.');\n  }\n}\n"]}